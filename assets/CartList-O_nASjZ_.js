import{m as r,s as u,_ as v,r as w,o,c as n,a as t,t as d,z as h,F as S,u as x,x as _,D as b,C as y,E as m,w as C,A as L,B}from"./index-UvZFmlvX.js";import{c as g,l as V}from"./userCartStore-jGcpH34R.js";import{c as k}from"./couponsStore-G6gutWzC.js";const q={data(){return{title:"購物車列表",couponCode:null}},mounted(){this.getCart()},computed:{...r(g,["cartList","cartTotal"]),...r(V,["loadingStatus"]),...r(k,["couponState"])},methods:{...u(g,["getCart","putCart","deleteCart","deleteCarts"]),...u(k,["postCoupon"]),async applyCoupon(){await this.postCoupon(this.couponCode).then(()=>{this.couponCode=""})}}},l=e=>(L("data-v-daece07e"),e=e(),B(),e),I={class:"col-4 mt-4 mb-4"},U={style:{position:"sticky",top:"0"}},$={class:"container d-flex justify-content-between"},D={class:"container table-responsive"},T={class:"table table-hover align-middle"},j=l(()=>t("thead",{class:"table-warning"},[t("tr",{class:"align-middle fw-bold",style:{height:"48px"}},[t("th",{scope:"col"},"品名"),t("th",{scope:"col"},"數量/單位"),t("th",{scope:"col",class:"text-end"},"單價"),t("th")])],-1)),z={key:0},A=l(()=>t("td",{colspan:"4"},[t("small",{class:"text-muted"}," 購物車目前沒有任何品項 ")],-1)),E=[A],F={style:{width:"120px"}},M=["src"],N={style:{width:"120px"},class:"pe-0"},Q={class:"d-flex justify-content-between align-items-center"},G={class:"input-group input-group-sm",style:{width:"80px"}},H=["disable","onClick","onUpdate:modelValue"],J={class:"input-group-text"},K={class:"m-0 border-0 d-flex",style:{width:"40px"}},O=["onClick"],P=l(()=>t("i",{class:"bi bi-trash3"},null,-1)),R=[P],W={style:{width:"110px"},class:"text-end"},X={class:"fs-6 mb-0"},Y={style:{width:"30px"},class:"text-end p-0"},Z=["onClick"],tt={class:"text-muted"},et=l(()=>t("td",null,"總計",-1)),st={key:0,class:"text-end"},ot={key:1,class:"text-end"},nt=l(()=>t("td",null,null,-1)),lt={colspan:"4"},at={class:"input-group"},dt=["disabled","placeholder"],ct={colspan:"4"},it=l(()=>t("button",{type:"button",class:"btn btn-outline-primary w-100",style:{height:"38px"}}," 前往商品列表 ",-1)),rt=l(()=>t("button",{type:"button",class:"btn btn-outline-success w-100",style:{height:"38px"}}," 前往購物車 ",-1));function pt(e,a,ut,ht,c,f){const p=w("router-link");return o(),n("div",I,[t("div",U,[t("div",$,[t("h2",null,d(c.title),1),e.cartList.length!==0?(o(),n("button",{key:0,onClick:a[0]||(a[0]=(...s)=>e.deleteCarts&&e.deleteCarts(...s)),type:"button",class:"btn btn-outline-danger btn-sm",style:{height:"38px"}}," 清空購物車 ")):h("",!0)]),t("div",D,[t("table",T,[j,t("tbody",null,[e.cartList.length===0?(o(),n("tr",z,E)):(o(!0),n(S,{key:1},x(e.cartList,s=>(o(),n("tr",{key:s.id},[t("td",F,[t("img",{src:s.product.imageUrl,class:"rounded cart-img"},null,8,M)]),t("td",N,[t("div",Q,[t("div",G,[_(t("input",{disable:s.id===e.loadingStatus.updateQty,onClick:i=>e.putCart(s),"onUpdate:modelValue":i=>s.qty=i,type:"number",min:"1",class:"form-control"},null,8,H),[[b,s.qty]]),t("span",J,d(s.product.unit),1)]),t("div",K,[t("button",{class:y([{"d-none":s.qty>1},"btn btn-outline-danger"]),onClick:i=>e.deleteCart(s.id),type:"button",style:{scale:"60%"}},R,10,O),s.id===e.loadingStatus.updateQty?(o(),n("span",{key:0,class:y([{"d-none":s.qty===1},"spinner-border spinner-border-sm ms-2"]),role:"status","aria-hidden":"true"},null,2)):h("",!0)])])]),t("td",W,[t("p",X,d(s.product.price)+"元",1)]),t("td",Y,[t("button",{onClick:i=>e.deleteCart(s.id),type:"button",class:"btn btn-outline-danger btn-sm py-0",style:{scale:"80%"}}," x ",8,Z)])]))),128))]),t("tfoot",null,[t("tr",null,[t("td",null,[t("small",tt,d(`總共 ${e.cartList.length} 項`),1)]),et,e.couponState.success?(o(),n("td",ot,d(Math.round(e.couponState.data.final_total))+"元",1)):(o(),n("td",st,d(e.cartTotal)+"元",1)),nt]),t("tr",null,[t("td",lt,[t("div",at,[_(t("input",{disabled:e.couponState.success,"onUpdate:modelValue":a[1]||(a[1]=s=>c.couponCode=s),type:"text",class:"form-control",placeholder:e.couponState.success?e.couponState.message:"請輸入優惠碼","aria-label":"coupon_code","aria-describedby":"coupon_code"},null,8,dt),[[b,c.couponCode]]),t("button",{onClick:a[2]||(a[2]=s=>f.applyCoupon(c.couponCode)),class:"btn btn-secondary",type:"button",id:"coupon_code"},"套用優惠卷")])])]),t("tr",null,[t("td",ct,[e.cartList.length===0?(o(),m(p,{key:0,to:{name:"products"}},{default:C(()=>[it]),_:1})):(o(),m(p,{key:1,to:{name:"cart"}},{default:C(()=>[rt]),_:1}))])])])])])])])}const mt=v(q,[["render",pt],["__scopeId","data-v-daece07e"]]);export{mt as C};
