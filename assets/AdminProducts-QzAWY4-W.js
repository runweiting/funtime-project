import{m as U,P as w}from"./Pagination-U6LhTfQ0.js";import{s as E}from"./showSuccessToast-yeD6Bdgu.js";import{s as A}from"./showErrorToast-Ee6WUOWD.js";import{_ as v,o as n,c as d,a as t,z as r,J as u,F as x,u as T,D as y,t as c,M,S as D,e as k,r as b,b as f}from"./index-mrn3Z3o4.js";var $={VITE_APP_URL:"https://vue3-course-api.hexschool.io/v2",VITE_APP_PATH:"runweiting",VITE_TEXT:"這是部屬完成的環境",BASE_URL:"/funtime-project/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_APP_URL:g,VITE_APP_PATH:P}=$,R={props:{tempData:Object,isNew:Boolean},data(){return{editModal:null,tempProduct:{imagesUrl:[],productRatings:0}}},emit:["getData"],mixins:[U],created(){this.tempProduct={...this.tempData}},watch:{tempData:{deep:!0,handler(a){this.tempProduct=a}}},methods:{updateData(){let a=`${g}/api/${P}/admin/product`,e="post";this.isNew||(a=`${g}/api/${P}/admin/product/${this.tempProduct.id}`,e="put"),this.axios[e](a,{data:this.tempProduct}).then(l=>{E(l.data.message),this.modal.hide(),this.$emit("getData")}).catch(l=>{A(l.response.data.message)})},upload(){const e=document.querySelector("#formFile").files[0],l=new FormData;l.append("file-to-upload",e);const _=`${g}/api/${P}/admin/upload`;this.axios.post(_,l)}}},I={class:"modal fade",id:"editModal",tabindex:"-1","aria-labelledby":"editModalLabel","aria-hidden":"true",ref:"modal"},S={class:"modal-dialog modal-xl modal-dialog-centered"},L={class:"modal-content"},C={class:"modal-header"},B={class:"modal-title",id:"editModalLabel"},O={key:0},N={key:1},j=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),H={class:"modal-body"},F={class:"container-fluid"},G={class:"row"},X={class:"col-md-4"},K={class:"mb-4"},q=t("label",{for:"imgUrl",class:"form-label"},"主要圖片",-1),z=["src"],J=t("h4",{class:"fw-bold"},"多圖新增",-1),Q={key:0,class:"mb-4"},W=["for"],Y=["id","onUpdate:modelValue"],Z=["src"],tt={class:"d-flex gap-2"},et=t("h4",{class:"fw-bold"},"上傳圖片",-1),ot={class:"mb-4"},st={class:"col-md-8"},lt=t("label",{for:"title",class:"form-label"},"標題",-1),at={class:"row"},it={class:"col-md-6"},nt=t("label",{for:"category",class:"form-label"},"分類",-1),dt={class:"col-md-6"},ct=t("label",{for:"unit",class:"form-label"},"單位",-1),rt={class:"row"},mt={class:"col-md-6"},ut=t("label",{for:"original_price",class:"form-label"},"原價",-1),pt={class:"col-md-6"},_t=t("label",{for:"price",class:"form-label"},"售價",-1),ht=t("hr",null,null,-1),bt=t("label",{for:"textarea",class:"form-label"},"商品描述",-1),ft=t("label",{for:"textarea",class:"form-label"},"說明內容",-1),gt={class:"row"},Pt={class:"col-md-6"},vt=t("label",{for:"range",class:"form-label"},"商品評價",-1),yt={class:"ms-2 text-primary fw-bold fs-5"},Dt={class:"col-md-6"},Ut={class:"form-check"},xt=t("label",{class:"form-label m-0",for:"product-active"},"啟用商品",-1),Tt={class:"switch ms-2"},Vt=t("span",{class:"slider"},null,-1),wt={class:"modal-footer"},Et=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function At(a,e,l,_,o,i){return n(),d("div",I,[t("div",S,[t("div",L,[t("div",C,[t("h5",B,[l.isNew?(n(),d("span",O,"新增商品")):(n(),d("span",N,"編輯商品"))]),j]),t("div",H,[t("div",F,[t("div",G,[t("div",X,[t("div",K,[q,r(t("input",{"onUpdate:modelValue":e[0]||(e[0]=s=>o.tempProduct.imageUrl=s),type:"url",class:"form-control mb-2",id:"imgUrl",placeholder:"請輸入網址"},null,512),[[u,o.tempProduct.imageUrl]]),t("img",{src:o.tempProduct.imageUrl,class:"img-fluid"},null,8,z)]),J,Array.isArray(o.tempProduct.imagesUrl)?(n(),d("div",Q,[(n(!0),d(x,null,T(o.tempProduct.imagesUrl,(s,p)=>(n(),d("div",{key:`url${p}`},[t("label",{for:`url${p}`,class:"form-label"},"圖片網址",8,W),r(t("input",{id:`url${p}`,"onUpdate:modelValue":h=>o.tempProduct.imagesUrl[p]=h,type:"url",class:"form-control mb-2",placeholder:"請輸入網址"},null,8,Y),[[u,o.tempProduct.imagesUrl[p]]]),t("img",{src:o.tempProduct.imagesUrl[p],class:"img-fluid mb-2"},null,8,Z)]))),128)),t("div",tt,[o.tempProduct.imagesUrl.length===0||o.tempProduct.imagesUrl[o.tempProduct.imagesUrl.length-1]?(n(),d("button",{key:0,onClick:e[1]||(e[1]=s=>o.tempProduct.imagesUrl.push("")),type:"button",class:"btn btn-outline-primary w-100"}," 新增圖片 ")):y("",!0),t("button",{onClick:e[2]||(e[2]=s=>o.tempProduct.imagesUrl.pop()),type:"button",class:"btn btn-outline-danger w-100"}," 刪除圖片 ")])])):y("",!0),et,t("div",ot,[t("input",{onChange:e[3]||(e[3]=(...s)=>i.upload&&i.upload(...s)),class:"form-control",type:"file",id:"formFile",placeholder:"請輸入圖片連結"},null,32)])]),t("div",st,[lt,r(t("input",{"onUpdate:modelValue":e[4]||(e[4]=s=>o.tempProduct.title=s),type:"text",class:"form-control mb-4",name:"title",placeholder:"請輸入標題"},null,512),[[u,o.tempProduct.title]]),t("div",at,[t("div",it,[nt,r(t("input",{"onUpdate:modelValue":e[5]||(e[5]=s=>o.tempProduct.category=s),type:"text",class:"form-control mb-4",id:"category",placeholder:"請輸入分類"},null,512),[[u,o.tempProduct.category]])]),t("div",dt,[ct,r(t("input",{"onUpdate:modelValue":e[6]||(e[6]=s=>o.tempProduct.unit=s),type:"text",class:"form-control mb-4",id:"unit",placeholder:"請輸入單位"},null,512),[[u,o.tempProduct.unit]])])]),t("div",rt,[t("div",mt,[ut,r(t("input",{"onUpdate:modelValue":e[7]||(e[7]=s=>o.tempProduct.origin_price=s),type:"number",min:"0",class:"form-control mb-4",id:"original_price",placeholder:"請輸入原價"},null,512),[[u,o.tempProduct.origin_price,void 0,{number:!0}]])]),t("div",pt,[_t,r(t("input",{"onUpdate:modelValue":e[8]||(e[8]=s=>o.tempProduct.price=s),type:"number",min:"0",class:"form-control mb-4",id:"price",placeholder:"請輸入售價"},null,512),[[u,o.tempProduct.price,void 0,{number:!0}]])])]),ht,t("div",null,[bt,r(t("textarea",{"onUpdate:modelValue":e[9]||(e[9]=s=>o.tempProduct.description=s),class:"form-control mb-4",placeholder:"請輸入商品描述",id:"textarea"},null,512),[[u,o.tempProduct.description]])]),t("div",null,[ft,r(t("textarea",{"onUpdate:modelValue":e[10]||(e[10]=s=>o.tempProduct.content=s),class:"form-control mb-4",placeholder:"請輸入說明內容",id:"textarea"},null,512),[[u,o.tempProduct.content]])]),t("div",gt,[t("div",Pt,[vt,t("span",yt,c(o.tempProduct.productRatings)+" 分 ",1),r(t("input",{"onUpdate:modelValue":e[11]||(e[11]=s=>o.tempProduct.productRatings=s),type:"range",class:"form-range",min:"0",max:"5",step:"1"},null,512),[[u,o.tempProduct.productRatings]])]),t("div",Dt,[t("div",Ut,[xt,t("label",Tt,[r(t("input",{"onUpdate:modelValue":e[12]||(e[12]=s=>o.tempProduct.is_enabled=s),type:"checkbox"},null,512),[[M,o.tempProduct.is_enabled]]),Vt])])])])])])])]),t("div",wt,[Et,t("button",{onClick:e[13]||(e[13]=(...s)=>i.updateData&&i.updateData(...s)),type:"button",class:"btn btn-primary"}," 確認 ")])])])],512)}const Mt=v(R,[["render",At]]);var kt={VITE_APP_URL:"https://vue3-course-api.hexschool.io/v2",VITE_APP_PATH:"runweiting",VITE_TEXT:"這是部屬完成的環境",BASE_URL:"/funtime-project/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_APP_URL:$t,VITE_APP_PATH:Rt}=kt,It={props:{tempData:Object},data(){return{delModal:null}},emit:["getData"],mixins:[U],methods:{deleteData(){const a=`${$t}/api/${Rt}/admin/product/${this.tempData.id}`;this.axios.delete(a).then(e=>{D.fire({title:e.data.message,icon:"success",confirmButtonText:"OK"})}).then(()=>{this.modal.hide(),this.$emit("getData")}).catch(e=>{D.fire({title:e.response.data.message,icon:"error",confirmButtonText:"OK"})})}}},St={class:"modal fade modal-lg",id:"delModal",tabindex:"-1","aria-labelledby":"delModalLabel","aria-hidden":"true",ref:"modal"},Lt={class:"modal-dialog modal-dialog-centered"},Ct={class:"modal-content"},Bt=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"delModalLabel"},"刪除商品"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),Ot={class:"modal-body"},Nt={class:"container-fluid"},jt={class:"row"},Ht={class:"col-sm-8"},Ft={class:"fw-bold text-danger"},Gt={class:"badge bg-dark ms-2"},Xt={class:"text-muted"},Kt={class:"col-sm-4"},qt=["src"],zt={class:"modal-footer"},Jt=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function Qt(a,e,l,_,o,i){return n(),d("div",St,[t("div",Lt,[t("div",Ct,[Bt,t("div",Ot,[t("div",Nt,[t("div",jt,[t("div",Ht,[t("h5",Ft,[k(c(l.tempData.title)+" ",1),t("span",Gt,c(l.tempData.category),1)]),t("p",null,c(l.tempData.description),1),t("p",null,[t("small",Xt," 原價: "+c(l.tempData.origin_price)+" / 售價: "+c(l.tempData.price),1)])]),t("div",Kt,[t("img",{src:l.tempData.imageUrl,class:"img-fluid"},null,8,qt)])])])]),t("div",zt,[Jt,t("button",{onClick:e[0]||(e[0]=(...s)=>i.deleteData&&i.deleteData(...s)),type:"button",class:"btn btn-danger"}," 確認刪除 ")])])])],512)}const Wt=v(It,[["render",Qt]]);var Yt={VITE_APP_URL:"https://vue3-course-api.hexschool.io/v2",VITE_APP_PATH:"runweiting",VITE_TEXT:"這是部屬完成的環境",BASE_URL:"/funtime-project/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_APP_URL:Zt,VITE_APP_PATH:te}=Yt,ee={components:{EditModal:Mt,DelModal:Wt,Pagination:w},data(){return{title:"這是商品頁面",products:[],isNew:!1,tempData:{imagesUrl:[],productRatings:0},pagination:{}}},mounted(){this.getProducts()},methods:{getProducts(a=1){const e=`${Zt}/api/${te}/admin/products?page=${a}`;this.axios.get(e).then(l=>{const{products:_,pagination:o}=l.data;this.products=_,this.pagination=o})},openModal(a,e){a==="new"?(this.tempData={imagesUrl:[],productRatings:0},this.isNew=!0,this.$refs.editModal.openModal(),console.log(this.products)):a==="edit"?(this.tempData={...e},Array.isArray(this.tempData.imagesUrl)||(this.tempData.imagesUrl=[]),this.isNew=!1,this.$refs.editModal.openModal(),console.log(this.products)):a==="delete"&&(this.tempData={...e},this.$refs.delModal.openModal())}}},oe={class:"container"},se={class:"row py-2"},le={class:"col mt-4 mb-4"},ae={class:"container py-2"},ie={class:"d-flex justify-content-between gap-2 py-2"},ne={class:"p-2 mb-0"},de={class:"d-flex justify-content-end gap-2"},ce={class:"container"},re={class:"table table-hover"},me=t("thead",{class:"table-dark fw-bold"},[t("tr",null,[t("th",{scope:"col"},"商品主圖"),t("th",{scope:"col"},"商品名稱"),t("th",{scope:"col"},"分類"),t("th",{scope:"col"},"原價"),t("th",{scope:"col"},"售價"),t("th",{scope:"col"},"是否啟用"),t("th",{scope:"col"},"編輯")])],-1),ue=["src"],pe={key:0,class:"bi bi-check-circle-fill text-success",style:{scale:"150%"}},_e={key:1,class:"bi bi-x-circle-fill text-danger",style:{scale:"150%"}},he={class:"btn-group",role:"group","aria-label":"Basic outlined example"},be=["onClick"],fe=["onClick"];function ge(a,e,l,_,o,i){const s=b("edit-modal"),p=b("del-modal"),h=b("Pagination");return n(),d("main",oe,[t("div",se,[t("div",le,[t("div",ae,[t("h2",null,c(o.title),1),t("div",ie,[t("p",ne,c(`一頁顯示 ${Object.keys(this.products).length} 項商品`),1),t("div",de,[t("button",{onClick:e[0]||(e[0]=m=>i.openModal("new")),type:"button",class:"btn btn-primary",id:"modalBtn"}," 建立新的商品 ")]),f(s,{ref:"editModal",tempData:o.tempData,"is-new":o.isNew,onGetData:i.getProducts},null,8,["tempData","is-new","onGetData"]),f(p,{ref:"delModal",tempData:o.tempData,onGetData:i.getProducts},null,8,["tempData","onGetData"])])]),t("div",ce,[t("table",re,[me,t("tbody",null,[(n(!0),d(x,null,T(o.products,m=>(n(),d("tr",{key:m.title},[t("td",null,[t("img",{src:m.imageUrl,class:"rounded",style:{height:"48px"}},null,8,ue)]),t("td",null,c(m.title),1),t("td",null,c(m.category),1),t("td",null,c(m.origin_price),1),t("td",null,c(m.price),1),t("td",null,[m.is_enabled?(n(),d("i",pe)):(n(),d("i",_e))]),t("td",null,[t("div",he,[t("button",{onClick:V=>i.openModal("edit",m),type:"button",class:"btn btn-outline-primary btn-sm"}," 編輯 ",8,be),t("button",{onClick:V=>i.openModal("delete",m),type:"button",class:"btn btn-outline-danger btn-sm"}," 刪除 ",8,fe)])])]))),128))])])]),f(h,{pages:o.pagination,onShowPage:i.getProducts},null,8,["pages","onShowPage"])])])])}const Ue=v(ee,[["render",ge]]);export{Ue as default};
