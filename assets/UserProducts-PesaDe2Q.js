import{x as w,y as A,m as _,_ as P,o as a,c as n,z as V,A as I,a as t,F as b,u as C,t as d,s as g,B as f,C as $,r as h,b as m,e as T,D as k,E as R,G as U}from"./index-mrn3Z3o4.js";import{u as y}from"./userProductsStore-LS1kdLOf.js";import{l as E,c as x}from"./cartStore-gPQ5Eopz.js";import{s as D}from"./showErrorToast-Ee6WUOWD.js";import{C as B}from"./CartList-rEt8e0Qy.js";import"./showSuccessToast-yeD6Bdgu.js";import"./couponsStore-YQAEtB1v.js";var H={VITE_APP_URL:"https://vue3-course-api.hexschool.io/v2",VITE_APP_PATH:"runweiting",VITE_TEXT:"這是部屬完成的環境",BASE_URL:"/funtime-project/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_APP_URL:N,VITE_APP_PATH:M}=H,v=w("categoryStore",{state:()=>({categoryList:[]}),actions:{getCategory(){const e=`${N}/api/${M}/products/all`;A.get(e).then(o=>{const{products:p}=o.data,c=new Set(p.map(l=>l.category));this.categoryList=[...c]})}}}),O={emits:["category-selected"],data(){return{currentCategory:""}},watch:{currentCategory(){this.$emit("category-selected",this.currentCategory,1)}},computed:{..._(v,["categoryList"])}},j=t("option",{value:""},"全部",-1),z=["value"];function F(e,o,p,c,l,i){return a(),n("div",null,[V(t("select",{"onUpdate:modelValue":o[0]||(o[0]=s=>l.currentCategory=s),class:"form-select form-select-sm"},[j,(a(!0),n(b,null,C(e.categoryList,s=>(a(),n("option",{key:s,value:s},d(s),9,z))),128))],512),[[I,l.currentCategory]])])}const G=P(O,[["render",F]]),X={emits:["page-selected"],data(){return{currentCategory:null}},computed:{..._(y,["pagination"])},methods:{...g(y,["getProducts"]),selectedPage(e){console.log(e),this.$emit("page-selected",this.currentCategory,e)}}},Q={class:"px-2"},q={"aria-label":"Page navigation example"},J={class:"pagination"},K=t("span",{"aria-hidden":"true"},"«",-1),W=[K],Y={key:0,class:"page-link"},Z=["onClick"],tt=t("span",{"aria-hidden":"true"},"»",-1),et=[tt];function st(e,o,p,c,l,i){return a(),n("div",Q,[t("nav",q,[t("ul",J,[t("li",{class:f([{disabled:e.pagination.current_page===1},"page-item"])},[t("a",{onClick:o[0]||(o[0]=$(s=>i.selectedPage(e.pagination.current_page-1),["prevent"])),class:"page-link",href:"#","aria-label":"Previous"},W)],2),(a(!0),n(b,null,C(e.pagination.total_pages,(s,u)=>(a(),n("li",{key:u,class:f([{active:s===e.pagination.current_page},"page-item"])},[s===e.pagination.current_page?(a(),n("span",Y,d(s),1)):(a(),n("a",{key:1,onClick:$(r=>i.selectedPage(s),["prevent"]),class:"page-link",href:"#"},d(s),9,Z))],2))),128)),t("li",{class:f([{disabled:e.pagination.current_page===e.pagination.total_pages},"page-item"])},[t("a",{onClick:o[1]||(o[1]=$(s=>i.selectedPage(e.pagination.current_page+1),["prevent"])),class:"page-link",href:"#","aria-label":"Next"},et)],2)])])])}const ot=P(X,[["render",st]]);var at={VITE_APP_URL:"https://vue3-course-api.hexschool.io/v2",VITE_APP_PATH:"runweiting",VITE_TEXT:"這是部屬完成的環境",BASE_URL:"/funtime-project/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_APP_URL:nt,VITE_APP_PATH:rt}=at,ct={components:{CategoryList:G,PaginationGroup:ot},data(){return{title:"商品列表",product:{}}},mounted(){this.getProducts(),this.getCategory()},computed:{..._(y,["productList"]),..._(v,["categoryList"]),..._(E,["loadingStatus"])},methods:{...g(y,["getProducts"]),...g(x,["addToCart"]),...g(v,["getCategory"]),handleCategoryChange(e){this.getProducts(e)},handlePageChange(e,o){this.getProducts(e,o)},async getProduct(e){const o=E();o.loadingStatus.getProduct=e;const p=`${nt}/api/${rt}/product/${e}`;this.$route.params.id=e;try{const c=await this.axios.get(p);this.product=c.data.product,o.loadingStatus.getProduct=""}catch(c){D(c.response.data.message)}finally{this.$router.push({name:"productInfo"})}}}},S=e=>(R("data-v-39ae476c"),e=e(),U(),e),it={class:"col-8 mt-4 mb-4",ref:"productList"},dt={class:"container d-flex justify-content-between"},lt={class:"p-2 mb-0"},pt={class:"container table-responsive"},ut={class:"table table-hover align-middle"},_t={class:"table-secondary"},gt={class:"align-middle fw-bold",style:{height:"48px"}},ht={scope:"col",style:{width:"17%"}},mt=S(()=>t("th",{scope:"col",style:{width:"30%"}},"商品名稱",-1)),yt=S(()=>t("th",{scope:"col",style:{width:"28%"}},"價格",-1)),Pt=S(()=>t("th",{scope:"col",style:{width:"25%"}},null,-1)),ft=["src"],$t={key:0,class:"fs-5 fw-bold mb-0"},vt={key:1},bt={class:"fs-6 fw-bold text-secondary"},Ct={class:"fs-5 fw-bold mb-0"},St={class:"d-flex flex-column gap-2"},Tt=["disabled","onClick"],kt={key:0,class:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"},Et=["onClick"],Lt={key:0,class:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"};function wt(e,o,p,c,l,i){const s=h("category-list"),u=h("pagination-group");return a(),n("div",it,[t("div",dt,[t("h2",null,d(l.title),1),t("p",lt,d(`目前有 ${e.productList.length} 項商品`),1)]),t("div",pt,[t("table",ut,[t("thead",_t,[t("tr",gt,[t("th",ht,[m(s,{onCategorySelected:i.handleCategoryChange},null,8,["onCategorySelected"])]),mt,yt,Pt])]),t("tbody",null,[(a(!0),n(b,null,C(e.productList,r=>(a(),n("tr",{key:r.title},[t("td",null,[t("img",{src:r.imageUrl,class:"rounded product-img"},null,8,ft)]),t("td",null,d(r.title),1),t("td",null,[r.origin_price===r.price?(a(),n("p",$t,d(r.price)+"元 ",1)):(a(),n("div",vt,[t("del",bt,"原價"+d(r.origin_price)+"元",1),t("p",Ct,"現在只要"+d(r.price)+"元",1)]))]),t("td",null,[t("div",St,[t("button",{disabled:r.id===this.loadingStatus.getProduct,onClick:L=>i.getProduct(r.id),type:"button",class:"btn btn-outline-secondary",id:"modalBtn"},[T(" 查看更多 "),r.id===this.loadingStatus.getProduct?(a(),n("span",kt)):k("",!0)],8,Tt),t("button",{onClick:L=>e.addToCart(r.id),type:"button",class:"btn btn-outline-danger"},[T(" 加入購物車 "),r.id===this.loadingStatus.updateQty?(a(),n("span",Lt)):k("",!0)],8,Et)])])]))),128))])]),m(u,{onPageSelected:i.handlePageChange},null,8,["onPageSelected"])])],512)}const At=P(ct,[["render",wt],["__scopeId","data-v-39ae476c"]]),Vt={components:{ProductList:At,CartList:B}},It={class:"container"},Rt=t("h1",{class:"pt-5 text-center"},"商品列表",-1),Ut={class:"row py-2"};function xt(e,o,p,c,l,i){const s=h("product-list"),u=h("cart-list");return a(),n("main",It,[Rt,t("div",Ut,[m(s),m(u)])])}const zt=P(Vt,[["render",xt]]);export{zt as default};
