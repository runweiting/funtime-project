import{E as O,s as b,_ as V,r as u,o as m,c as _,b as l,w as f,a as e,B as r,C as $,D as w,m as y,F as x,u as q,t as i,e as k}from"./index-fCAb3gEa.js";import{u as U}from"./userCartStore-I14EMXsv.js";import{c as g}from"./adminCouponsStore-byniDI9F.js";import{u as E}from"./userOrderStore-lKqbhvXW.js";import{O as M}from"./OrderSteps-P6M5UMhb.js";import{O as N}from"./OrderHeader-u52iuWCz.js";import"./showSuccessToast-LIQr3UAc.js";import"./showErrorToast-_Do5t9Hk.js";const T={emits:["updateCart"],components:{ErrorMessage:O},data(){return{data:{user:{name:"",tel:"",email:"",shipment:"宅配到府",country:"",city:"",region:"",postcode:"",address:""},message:"",agreement:!1}}},watch:{"data.agreement":{deep:!0,handler(c){c==="true"&&(this.data.agreement=!0)}}},methods:{...b(g,["clearCoupon"]),...b(E,["createOrder"]),onSubmit(){this.createOrder(this.data),this.$refs.formOrder.resetForm(),this.data.message="",this.$emit("updateCart"),this.clearCoupon(),this.$router.push({name:"order-result"})}}},F={class:"rounded-5 border border-5 border-light p-5 h-100"},j=e("h3",{class:"fs-5"},"收件人",-1),D={class:"row"},B={class:"col"},H={class:"form-floating mb-3"},L=e("label",{for:"姓名",class:"form-label"},"真實姓名",-1),z={class:"col"},A={class:"form-floating mb-3"},G=e("label",{for:"手機",class:"form-label"},"手機",-1),I={class:"form-floating"},J=e("label",{for:"email",class:"form-label"},"Email",-1),K=e("h4",{class:"fs-6"},"請選擇運送方式",-1),P=e("option",{value:"宅配到府",selected:""},"宅配到府",-1),Q={class:"row mb-3"},R={class:"col"},W=e("label",{for:"country",class:"form-label text-dark-gray"},"收件地點",-1),X=e("option",{value:"",selected:""},"請選擇",-1),Y=e("option",{value:"台灣"},"台灣",-1),Z=e("option",{value:"國際"},"國際",-1),ee={class:"col"},se=e("label",{for:"city",class:"form-label text-dark-gray"},"縣市",-1),oe=e("option",{value:"",selected:""},"請選擇",-1),te=e("option",{value:"台北"},"台北",-1),le=e("option",{value:"台中"},"台中",-1),ae=e("option",{value:"高雄"},"高雄",-1),de={class:"col"},ne=e("label",{for:"region",class:"form-label text-dark-gray"},"鄉鎮市區",-1),ie=e("option",{value:"",selected:""},"請選擇",-1),re=e("option",{value:"北區"},"北區",-1),ce=e("option",{value:"中區"},"中區",-1),ue=e("option",{value:"南區"},"南區",-1),me={class:"row mb-3"},_e={class:"col"},pe={class:"form-floating"},fe=e("label",{for:"postcode",class:"form-label"},"郵遞區號",-1),he={class:"col"},be={class:"form-floating"},ge=e("label",{for:"address",class:"form-label"},"地址",-1),ve=e("label",{for:"message",class:"form-label text-dark-gray"},"備註(選填)",-1),ye={class:"form-check"},xe=e("label",{class:"form-check-label text-dark-gray",for:"agreement"}," 我已閱讀並同意 funtime 服務條款與隱私權政策。 ",-1),ke=e("div",{class:"text-end mt-auto"},[e("button",{type:"submit",class:"btn btn-primary text-white"},"送出訂單")],-1);function Ve(c,t,S,C,o,h){const a=u("VField"),d=u("ErrorMessage"),p=u("VForm");return m(),_("div",F,[l(p,{ref:"formOrder",class:"d-flex flex-column gap-3 h-100",onSubmit:h.onSubmit},{default:f(({errors:n})=>[e("div",null,[j,e("div",D,[e("div",B,[e("div",H,[l(a,{modelValue:o.data.user.name,"onUpdate:modelValue":t[0]||(t[0]=s=>o.data.user.name=s),modelModifiers:{trim:!0},rules:"required",class:r([{"is-invalid":n.姓名},"form-control"]),type:"text",name:"姓名"},null,8,["modelValue","class"]),L,l(d,{name:"姓名",class:"invalid-feedback"})])]),e("div",z,[e("div",A,[l(a,{modelValue:o.data.user.tel,"onUpdate:modelValue":t[1]||(t[1]=s=>o.data.user.tel=s),modelModifiers:{trim:!0},rules:"required|min:8|max:10",class:r([{"is-invalid":n.手機},"form-control"]),type:"tel",name:"手機"},null,8,["modelValue","class"]),G,l(d,{name:"手機",class:"invalid-feedback"})])])]),e("div",I,[l(a,{modelValue:o.data.user.email,"onUpdate:modelValue":t[2]||(t[2]=s=>o.data.user.email=s),modelModifiers:{trim:!0},rules:"required|email",class:r([{"is-invalid":n.email},"form-control"]),type:"email",name:"email"},null,8,["modelValue","class"]),J,l(d,{name:"email",class:"invalid-feedback"})])]),e("div",null,[K,l(a,{modelValue:o.data.user.shipment,"onUpdate:modelValue":t[3]||(t[3]=s=>o.data.user.shipment=s),rules:"required",class:r([{"is-invalid":n.運送方式},"form-select bg-light text-center text-dark-gray"]),as:"select",name:"運送方式","aria-label":"shipment",disabled:""},{default:f(()=>[P]),_:2},1032,["modelValue","class"]),l(d,{name:"運送方式",class:"invalid-feedback"})]),e("div",null,[e("div",Q,[e("div",R,[W,l(a,{modelValue:o.data.user.country,"onUpdate:modelValue":t[4]||(t[4]=s=>o.data.user.country=s),rules:"required",class:r([{"is-invalid":n.地點},"form-select text-dark-gray"]),as:"select",name:"地點","aria-label":"country"},{default:f(()=>[X,Y,Z]),_:2},1032,["modelValue","class"]),l(d,{name:"地點",class:"invalid-feedback"})]),e("div",ee,[se,l(a,{modelValue:o.data.user.city,"onUpdate:modelValue":t[5]||(t[5]=s=>o.data.user.city=s),rules:"required",class:r([{"is-invalid":n.縣市},"form-select text-dark-gray"]),as:"select",name:"縣市","aria-label":"city"},{default:f(()=>[oe,te,le,ae]),_:2},1032,["modelValue","class"]),l(d,{name:"縣市",class:"invalid-feedback"})]),e("div",de,[ne,l(a,{modelValue:o.data.user.region,"onUpdate:modelValue":t[6]||(t[6]=s=>o.data.user.region=s),rules:"required",class:r([{"is-invalid":n.鄉鎮市區},"form-select text-dark-gray"]),as:"select",name:"鄉鎮市區","aria-label":"region"},{default:f(()=>[ie,re,ce,ue]),_:2},1032,["modelValue","class"]),l(d,{name:"鄉鎮市區",class:"invalid-feedback"})])]),e("div",me,[e("div",_e,[e("div",pe,[l(a,{modelValue:o.data.user.postcode,"onUpdate:modelValue":t[7]||(t[7]=s=>o.data.user.postcode=s),modelModifiers:{trim:!0},rules:"required",class:r([{"is-invalid":n.郵遞區號},"form-control"]),type:"text",name:"郵遞區號"},null,8,["modelValue","class"]),fe,l(d,{name:"郵遞區號",class:"invalid-feedback"})])]),e("div",he,[e("div",be,[l(a,{modelValue:o.data.user.address,"onUpdate:modelValue":t[8]||(t[8]=s=>o.data.user.address=s),modelModifiers:{trim:!0},rules:"required",class:r([{"is-invalid":n.地址},"form-control"]),type:"text",name:"地址"},null,8,["modelValue","class"]),ge,l(d,{name:"地址",class:"invalid-feedback"})])])]),e("div",null,[ve,$(e("textarea",{"onUpdate:modelValue":t[9]||(t[9]=s=>o.data.message=s),id:"message",class:"form-control",rows:"3"},null,512),[[w,o.data.message,void 0,{trim:!0}]])])]),e("div",ye,[l(a,{modelValue:o.data.agreement,"onUpdate:modelValue":t[10]||(t[10]=s=>o.data.agreement=s),rules:"required",class:r([{"is-invalid":n["funtime 服務條款"]},"form-check-input"]),type:"checkbox",name:"funtime 服務條款",id:"agreement",value:"true"},null,8,["modelValue","class"]),xe,l(d,{name:"funtime 服務條款",class:"invalid-feedback"})]),ke]),_:1},8,["onSubmit"])])}const $e=V(T,[["render",Ve]]),we={components:{OrderSteps:M,OrderDetail:$e,OrderHeader:N},data(){return{currentFundraisingSteps:1,currentOrderSteps:2,couponCode:null}},computed:{...y(U,["cartList","cartTotal"]),...y(g,["couponState"])},methods:{...b(g,["postCoupon"]),async applyCoupon(){await this.postCoupon(this.couponCode).then(()=>{this.couponCode=""})}}},Se={class:"mx-3 mx-lg-10"},Ce={class:"mx-3 mx-lg-10"},Oe={class:"container px-lg-12 py-3 py-lg-6"},qe={class:"row row-cols-1"},Ue={class:"col-md-6 col-lg-5 px-xl-4"},Ee={class:"d-flex flex-column justify-content-between rounded-5 border border-5 border-light p-5 gap-3 position-relative mb-3"},Me=["src"],Ne={class:"fs-6 text-dark-gray mb-0"},Te={class:"d-flex justify-content-between align-items-center"},Fe={class:"d-flex gap-2"},je={class:"fw-bold mb-0"},De={class:"badge bg-info-light text-black"},Be={class:"fs-6 badge bg-danger"},He={class:"text-dark-gray"},Le=e("span",null,"本方案內含：",-1),ze=e("br",null,null,-1),Ae={class:"fs-5 fw-bold"},Ge=e("hr",{class:"w-100 border-top my-1",style:{border:"3px dotted #8C8C8E"}},null,-1),Ie=e("div",{class:"d-flex align-items-center gap-2"},[e("i",{class:"bi bi-check-circle-fill text-dark-secondary"}),e("small",null,"臺灣本島免運、可寄離島")],-1),Je={class:"rounded-5 border border-5 border-light-gray p-5 gap-3"},Ke=e("label",{for:"coupon-code",class:"form-label text-danger fw-medium"},"優惠卷",-1),Pe={class:"input-group mb-3"},Qe=["disabled","placeholder"],Re=e("h6",{class:"mb-2"},"付款明細",-1),We={class:"d-flex flex-column gap-1 px-2"},Xe={class:"d-flex justify-content-between text-dark-gray"},Ye=e("span",null,"項目",-1),Ze=e("div",{class:"d-flex justify-content-between text-dark-gray"},[e("span",null,"運費"),e("span",null,"NT$ 0")],-1),es=e("hr",{class:"bg-light-gray my-2"},null,-1),ss={key:0,class:"d-flex justify-content-between text-dark-gray fw-bold"},os=e("span",null,"總計",-1),ts={class:"fw-bold mb-0"},ls={key:1,class:"d-flex justify-content-between text-dark-gray fw-bold"},as=e("span",null,"折扣總計",-1),ds={class:"fw-bold mb-0"},ns={class:"col-md-6 col-lg-7 px-xl-4 gy-3 gy-md-0"},is={class:"d-none p-5"},rs=e("h3",{class:"fs-5"},"會員資料",-1),cs={ref:"form-member"},us={class:"form-floating mb-3"},ms=e("input",{type:"email",class:"form-control",id:"floatingEmail",name:"email",placeholder:"請輸入email",disabled:""},null,-1),_s=e("label",{for:"floatingEmail",class:"form-label"},"Email",-1),ps={class:"row"},fs={class:"col"},hs={class:"form-floating mb-3"},bs=e("input",{type:"text",class:"form-control",id:"floatingName",name:"姓名",placeholder:"請輸入姓名",disabled:""},null,-1),gs=e("label",{for:"floatingName",class:"form-label"},"收件人姓名",-1),vs={class:"col"},ys={class:"form-floating mb-3"},xs=e("input",{type:"tel",class:"form-control",id:"floatingTel",name:"手機",disabled:""},null,-1),ks=e("label",{for:"floatingTel",class:"form-label"},"手機",-1);function Vs(c,t,S,C,o,h){const a=u("OrderHeader"),d=u("OrderSteps"),p=u("ErrorMessage"),n=u("OrderDetail");return m(),_(x,null,[l(a,{currentFundraisingSteps:o.currentFundraisingSteps},null,8,["currentFundraisingSteps"]),e("div",Se,[l(d,{currentOrderSteps:o.currentOrderSteps},null,8,["currentOrderSteps"])]),e("div",Ce,[e("div",Oe,[e("div",qe,[e("div",Ue,[(m(!0),_(x,null,q(c.cartList,s=>(m(),_("div",{key:s.id,class:"position-sticky top-0"},[e("div",Ee,[e("img",{src:s.product.imageUrl,alt:"product-image",class:"card-img-top object-fit-cover img-fluid rounded",style:{"max-height":"100px"}},null,8,Me),e("h3",Ne,i(s.qty)+" 入組",1),e("div",Te,[e("div",Fe,[e("h5",je,"NT$ "+i(s.total),1),e("span",De,i(s.product.discount*100)+"折",1)]),e("span",Be,"剩餘"+i(s.product.target_units-s.qty)+"份",1)]),e("small",He,[k("預定售價 "),e("del",null,"NT$ "+i(s.product.origin_price),1),k("，現省 NT$ "+i(s.product.origin_price*s.qty-s.product.origin_price*s.product.discount*s.qty),1)]),e("div",null,[Le,ze,e("span",Ae,i(s.product.short_title)+i(s.qty)+" 套",1)]),Ge,Ie]),e("div",Je,[Ke,e("div",Pe,[$(e("input",{disabled:c.couponState.success,"onUpdate:modelValue":t[0]||(t[0]=v=>o.couponCode=v),type:"text",class:"form-control",placeholder:c.couponState.success?c.couponState.message:"請輸入優惠碼","aria-label":"coupon-code","aria-describedby":"coupon-code",id:"coupon-code"},null,8,Qe),[[w,o.couponCode]]),e("button",{onClick:t[1]||(t[1]=v=>h.applyCoupon(o.couponCode)),class:"btn btn-danger text-white",type:"button",id:"coupon-code"},"確認")]),Re,e("div",We,[e("div",Xe,[Ye,e("span",null,"NT$ "+i(s.total),1)]),Ze,es,c.couponState.success?(m(),_("div",ls,[as,e("h5",ds,"NT$ "+i(Math.round(c.couponState.data.final_total)),1)])):(m(),_("div",ss,[os,e("h5",ts,"NT$ "+i(s.total),1)]))])])]))),128))]),e("div",ns,[e("div",is,[rs,e("form",cs,[e("div",us,[ms,_s,l(p,{name:"email",class:"invalid-feedback"})]),e("div",ps,[e("div",fs,[e("div",hs,[bs,gs,l(p,{name:"姓名",class:"invalid-feedback"})])]),e("div",vs,[e("div",ys,[xs,ks,l(p,{name:"手機",class:"invalid-feedback"})])])])],512)]),l(n)])])])])],64)}const Ms=V(we,[["render",Vs]]);export{Ms as default};
