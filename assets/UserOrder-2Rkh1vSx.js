import{_ as S,o as a,c as i,a as s,C as r,m as x,s as y,S as v,r as _,F as g,u as k,b as n,w,e as p,t as e,x as j,D as P}from"./index-UvZFmlvX.js";import{c as $}from"./userCartStore-jGcpH34R.js";import{O as E}from"./OrderDetail-Uvb_nqFC.js";import{F as D}from"./FundraisingSteps-PfcMjFZK.js";import{c as C}from"./couponsStore-G6gutWzC.js";import"./showSuccessToast-bQTajdBV.js";import"./showErrorToast-1wWGzD5-.js";const L={data(){return{currentProgress:1}}},q={class:"container bg-light rounded-5 px-6 py-3 px-lg-12 px-xl-15"},B={class:"d-flex justify-content-center gap-1 gap-414-2 gap-md-6 gap-lg-12"},F={class:"d-flex align-items-center gap-2 gap-lg-4"},U=s("span",{class:"span-lh-ls"},"確認品項",-1),M=s("i",{class:"bi bi-chevron-right"},null,-1),V={class:"d-flex align-items-center gap-2 gap-lg-4 text-gray"},K=s("i",{class:"bi bi-chevron-right"},null,-1),R={class:"d-flex align-items-center gap-2 gap-lg-4 text-gray"};function z(o,c,u,d,l,h){return a(),i("div",q,[s("div",B,[s("div",F,[s("i",{class:r([{"text-dark-secondary":l.currentProgress>=1},"bi bi-check-circle-fill"])},null,2),U]),M,s("div",V,[s("i",{class:r([{"text-dark-secondary":l.currentProgress>=2},"bi bi-check-circle-fill"])},null,2),s("span",{class:r([{"text-black":l.currentProgress>=2},"span-lh-ls text-gray"])},"填寫訂單",2)]),K,s("div",R,[s("i",{class:r([{"text-dark-secondary":l.currentProgress>=3},"bi bi-check-circle-fill"])},null,2),s("span",{class:r([{"text-black":l.currentProgress>=3},"span-lh-ls"])},"預購結果",2)])])])}const A=S(L,[["render",z]]),G={components:{FundraisingSteps:D,OrderSteps:A,OrderDetail:E},data(){return{apiUrl:"https://vue3-course-api.hexschool.io/v2",apiPath:"runweiting",couponCode:null}},mounted(){this.getCart()},computed:{...x($,["cartList","cartTotal"]),...x(C,["couponState"])},methods:{...y($,["getCart"]),...y(C,["postCoupon"]),async applyCoupon(){await this.postCoupon(this.couponCode).then(()=>{this.couponCode=""})},createOrder(o){const c={data:o},u=`${this.apiUrl}/api/${this.apiPath}/order`;this.axios.post(u,c).then(d=>{v.fire({title:d.data.message,icon:"success",confirmButtonText:"OK"}),this.$refs.orderDetail.resetForm(),this.getCart()}).catch(d=>{v.fire({title:d.data.message,icon:"error",confirmButtonText:"OK"})})}}},H={class:"mx-3 mx-lg-10"},I={class:"container px-lg-12 mb-3 mb-lg-6"},J={class:"row row-cols-1 gy-3 gy-lg-6 row-cols-md-2 px-md-2 px-lg-3 px-xl-4"},Q={class:"col px-xl-4"},W={class:"d-flex gap-2 mb-3","aria-label":"breadcrumb"},X={class:"text-dark-gray"},Y=s("small",{class:"text-dark-gray"},"/",-1),Z={class:"text-dark-gray"},ss={class:"fs-4 card-title fw-bold mb-3"},ts={class:"d-flex align-items-baseline gap-3"},es=s("small",{class:"text-dark-gray"},"提案人",-1),os={class:"text-dark-gray"},ls={class:"col px-xl-4"},ns={class:"mx-3 mx-lg-10"},as={class:"mx-3 mx-lg-10"},is={class:"container px-lg-12 py-3 py-lg-6"},cs={class:"row row-cols-1"},ds={class:"position-sticky top-0"},rs={class:"d-flex flex-column justify-content-between rounded-5 border border-5 border-light p-5 gap-3 position-relative mb-3"},_s=["src"],ps={class:"fs-6 text-dark-gray mb-0"},us={class:"d-flex justify-content-between align-items-center"},hs={class:"d-flex gap-2"},ms={class:"fw-bold mb-0"},gs={class:"badge bg-info-light text-black"},fs={class:"fs-6 badge bg-danger"},bs={class:"text-dark-gray"},xs=s("span",null,"本方案內含：",-1),ys=s("br",null,null,-1),vs={class:"fs-5 fw-bold"},ks=s("hr",{class:"w-100 border-top my-1",style:{border:"3px dotted #8C8C8E"}},null,-1),ws=s("div",{class:"d-flex align-items-center gap-2"},[s("i",{class:"bi bi-check-circle-fill text-dark-secondary"}),s("small",null,"臺灣本島免運、可寄離島")],-1),$s={class:"rounded-5 border border-5 border-light-gray p-5 gap-3"},Cs=s("label",{for:"coupon-code",class:"form-label text-danger fw-medium"},"優惠卷",-1),Ss={class:"input-group mb-3"},Ts=["disabled","placeholder"],Ns=s("h6",{class:"mb-2"},"付款明細",-1),Os={class:"d-flex flex-column gap-1 px-2"},js={class:"d-flex justify-content-between text-dark-gray"},Ps=s("span",null,"項目",-1),Es=s("div",{class:"d-flex justify-content-between text-dark-gray"},[s("span",null,"運費"),s("span",null,"NT$ 0")],-1),Ds=s("hr",{class:"bg-light-gray my-2"},null,-1),Ls={key:0,class:"d-flex justify-content-between text-dark-gray fw-bold"},qs=s("span",null,"總計",-1),Bs={class:"fw-bold mb-0"},Fs={key:1,class:"d-flex justify-content-between text-dark-gray fw-bold"},Us=s("span",null,"折扣總計",-1),Ms={class:"fw-bold mb-0"},Vs={class:"col-md-6 col-lg-7 px-xl-4 gy-3 gy-md-0"},Ks={class:"d-none p-5"},Rs=s("h3",{class:"fs-5"},"會員資料",-1),zs={ref:"form-member"},As={class:"form-floating mb-3"},Gs=s("input",{type:"email",class:"form-control",id:"floatingEmail",name:"email",placeholder:"請輸入email",disabled:""},null,-1),Hs=s("label",{for:"floatingEmail",class:"form-label"},"Email",-1),Is={class:"row"},Js={class:"col"},Qs={class:"form-floating mb-3"},Ws=s("input",{type:"text",class:"form-control",id:"floatingName",name:"姓名",placeholder:"請輸入姓名",disabled:""},null,-1),Xs=s("label",{for:"floatingName",class:"form-label"},"收件人姓名",-1),Ys={class:"col"},Zs={class:"form-floating mb-3"},st=s("input",{type:"tel",class:"form-control",id:"floatingTel",name:"手機",disabled:""},null,-1),tt=s("label",{for:"floatingTel",class:"form-label"},"手機",-1);function et(o,c,u,d,l,h){const f=_("RouterLink"),T=_("fundraising-steps"),N=_("order-steps"),m=_("ErrorMessage"),O=_("order-detail");return a(),i(g,null,[s("div",H,[s("div",I,[s("div",J,[s("div",Q,[(a(!0),i(g,null,k(o.cartList,t=>(a(),i("div",{key:t.id,class:"h-100 d-flex flex-column justify-content-between"},[s("nav",W,[s("small",X,[n(f,{to:{name:"home"},class:"nav-link text-decoration-none text-nowrap"},{default:w(()=>[p(e(o.$t("menu.home")),1)]),_:1})]),Y,s("small",Z,[n(f,{to:{name:"products"},class:"nav-link text-decoration-none text-nowrap"},{default:w(()=>[p(e(o.$t("menu.products")),1)]),_:1})])]),s("h2",ss,e(t.product.title),1),s("div",ts,[es,s("small",os,e(t.product.proposer),1)])]))),128))]),s("div",ls,[n(T)])])])]),s("div",ns,[n(N)]),s("div",as,[s("div",is,[s("div",cs,[(a(!0),i(g,null,k(o.cartList,t=>(a(),i("div",{key:t.id,class:"col-md-6 col-lg-5 px-xl-4"},[s("div",ds,[s("div",rs,[s("img",{src:t.product.imageUrl,class:"card-img-top object-fit-cover img-fluid rounded",alt:"boardGame1",style:{"max-height":"100px"}},null,8,_s),s("h3",ps,e(t.qty)+" 入組",1),s("div",us,[s("div",hs,[s("h5",ms,"NT$ "+e(t.total),1),s("span",gs,e(t.product.discount*100)+"折",1)]),s("span",fs,"剩餘"+e(t.product.target_units-t.qty)+"份",1)]),s("small",bs,[p("預定售價 "),s("del",null,"NT$ "+e(t.product.origin_price),1),p("，現省 NT$ "+e(t.product.origin_price*t.qty-t.product.origin_price*t.product.discount*t.qty),1)]),s("div",null,[xs,ys,s("span",vs,e(t.product.short_title)+e(t.qty)+" 套",1)]),ks,ws]),s("div",$s,[Cs,s("div",Ss,[j(s("input",{disabled:o.couponState.success,"onUpdate:modelValue":c[0]||(c[0]=b=>l.couponCode=b),type:"text",class:"form-control",placeholder:o.couponState.success?o.couponState.message:"請輸入優惠碼","aria-label":"coupon-code","aria-describedby":"coupon-code",id:"coupon-code"},null,8,Ts),[[P,l.couponCode]]),s("button",{onClick:c[1]||(c[1]=b=>h.applyCoupon(l.couponCode)),class:"btn btn-danger text-white",type:"button",id:"coupon-code"},"確認")]),Ns,s("div",Os,[s("div",js,[Ps,s("span",null,"NT$ "+e(t.total),1)]),Es,Ds,o.couponState.success?(a(),i("div",Fs,[Us,s("h5",Ms,"NT$ "+e(Math.round(o.couponState.data.final_total)),1)])):(a(),i("div",Ls,[qs,s("h5",Bs,"NT$ "+e(t.total),1)]))])])])]))),128)),s("div",Vs,[s("div",Ks,[Rs,s("form",zs,[s("div",As,[Gs,Hs,n(m,{name:"email",class:"invalid-feedback"})]),s("div",Is,[s("div",Js,[s("div",Qs,[Ws,Xs,n(m,{name:"姓名",class:"invalid-feedback"})])]),s("div",Ys,[s("div",Zs,[st,tt,n(m,{name:"手機",class:"invalid-feedback"})])])])],512)]),n(O,{onSendOrder:h.createOrder,ref:"orderDetail"},null,8,["onSendOrder"])])])])])],64)}const rt=S(G,[["render",et]]);export{rt as default};
