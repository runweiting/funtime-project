import{C as f,B as x,D as l,H as d,_ as N,m as C,a as S,r as m,o as h,c as w,b as e,d as s,w as n,I as A,A as T,F as E,g as c}from"./index-DW-YAaVl.js";import{s as _}from"./showSuccessToast-4Q0mJWPL.js";import{s as v}from"./showErrorToast-3Rr6__rM.js";var L={VITE_APP_URL:"https://vue3-course-api.hexschool.io/v2",VITE_APP_PATH:"runweiting",BASE_URL:"/funtime-project/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const V=f.useLoading(),{VITE_APP_URL:p}=L,g=x("loginStore",{state:()=>({checkSuccess:!1}),actions:{checkLogin(){const a=V.show(),o=`${p}/api/user/check`,r=document.cookie.replace(/(?:(?:^|.*;\s*)myToken\s*=\s*([^;]*).*$)|^.*$/,"$1");r?(l.defaults.headers.common.Authorization=r,l.post(o).then(()=>{this.checkSuccess=!0,_("驗證成功")}).catch(u=>{v(u.response.data.message).then(()=>{d.push({name:"login"})})}).finally(()=>{a.hide()})):d.push({name:"login"})},logout(){const a=`${p}/logout`;l.post(a).then(o=>{_(o.data.message).then(()=>{document.cookie="myToken=; expires=;",l.defaults.headers.common.Authorization=null,d.push({name:"home"})})}).catch(o=>{v(o.response.data.message)})}}}),y={created(){this.checkLogin()},computed:{...C(g,["checkSuccess"])},methods:{...S(g,["checkLogin","logout"]),closeNavbar(){const a=document.querySelector(".navbar-toggler");a.getAttribute("aria-expanded")==="true"&&a.click()}}},R={class:"navbar navbar-expand-lg navbar-dark bg-dark"},P={class:"container px-4"},B={class:"mb-0 overflow-hidden",style:{"white-space":"nowrap"}},$=e("button",{class:"navbar-toggler",type:"button","data-bs-toggle":"collapse","data-bs-target":"#navbarNav","aria-controls":"navbarNav","aria-expanded":"false","aria-label":"Toggle navigation"},[e("span",{class:"navbar-toggler-icon"})],-1),D={class:"collapse navbar-collapse justify-content-end",id:"navbarNav"},I={class:"navbar-nav gap-2"},U={class:"nav-item"},j={class:"nav-item"},z={class:"nav-item"},F={class:"nav-item"},H={class:"nav-item"},O={class:"nav-item"};function q(a,o,r,u,M,i){const t=m("RouterLink"),b=m("RouterView");return h(),w(E,null,[e("header",null,[e("nav",R,[e("div",P,[e("h1",B,[s(t,{to:{name:"admin/products"},class:"navbar-brand mb-0 fs-2 fw-bold"},{default:n(()=>[c("funtime ")]),_:1})]),$,e("div",D,[e("ul",I,[e("li",U,[s(t,{onClick:i.closeNavbar,to:{name:"admin/products"},class:"nav-link text-decoration-none"},{default:n(()=>[c("編輯商品")]),_:1},8,["onClick"])]),e("li",j,[s(t,{onClick:i.closeNavbar,to:{name:"admin/orders"},class:"nav-link text-decoration-none"},{default:n(()=>[c("編輯訂單")]),_:1},8,["onClick"])]),e("li",z,[s(t,{onClick:i.closeNavbar,to:{name:"admin/coupons"},class:"nav-link text-decoration-none"},{default:n(()=>[c("編輯優惠卷")]),_:1},8,["onClick"])]),e("li",F,[s(t,{onClick:i.closeNavbar,to:{name:"admin/articles"},class:"nav-link text-decoration-none"},{default:n(()=>[c("編輯文章")]),_:1},8,["onClick"])]),e("li",H,[s(t,{onClick:i.closeNavbar,to:{name:"home"},class:"nav-link text-decoration-none"},{default:n(()=>[c("回到前台")]),_:1},8,["onClick"])]),e("li",O,[e("button",{onClick:o[0]||(o[0]=(...k)=>a.logout&&a.logout(...k)),type:"button",class:"btn btn-warning"}," 登出 ")])])])])])]),e("main",null,[a.checkSuccess?(h(),A(b,{key:0})):T("",!0)])],64)}const Q=N(y,[["render",q]]);export{Q as default};
