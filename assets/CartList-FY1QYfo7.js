import{m as r,s as u,_ as v,r as w,o,c as n,a as t,t as d,D as h,F as S,u as x,z as _,J as b,B as y,v as m,w as C,E as L,G as B}from"./index-z0OJsCB6.js";import{c as g,l as V}from"./cartStore-rki9Q5Yc.js";import{c as k}from"./couponsStore-9K3AO9BF.js";const q={data(){return{title:"購物車列表",couponCode:null}},mounted(){this.getCart()},computed:{...r(g,["cartList","cartTotal"]),...r(V,["loadingStatus"]),...r(k,["couponState"])},methods:{...u(g,["getCart","putCart","deleteCart","deleteCarts"]),...u(k,["postCoupon"]),async applyCoupon(){await this.postCoupon(this.couponCode).then(()=>{this.couponCode=""})}}},l=s=>(L("data-v-9e67b2d9"),s=s(),B(),s),I={class:"col-4 mt-4 mb-4"},U={style:{position:"sticky",top:"0"}},$={class:"container d-flex justify-content-between"},D={class:"container table-responsive"},T={class:"table table-hover align-middle"},j=l(()=>t("thead",{class:"table-warning"},[t("tr",{class:"align-middle fw-bold",style:{height:"48px"}},[t("th",{scope:"col"},"品名"),t("th",{scope:"col"},"數量/單位"),t("th",{scope:"col",class:"text-end"},"單價"),t("th")])],-1)),z={key:0},E=l(()=>t("td",{colspan:"4"},[t("small",{class:"text-muted"}," 購物車目前沒有任何品項 ")],-1)),F=[E],M={style:{width:"120px"}},N=["src"],Q={style:{width:"120px"},class:"pe-0"},A={class:"d-flex justify-content-between align-items-center"},G={class:"input-group input-group-sm",style:{width:"80px"}},J=["disable","onClick","onUpdate:modelValue"],H={class:"input-group-text"},K={class:"m-0 border-0 d-flex",style:{width:"40px"}},O=["onClick"],P=l(()=>t("i",{class:"bi bi-trash3"},null,-1)),R=[P],W={style:{width:"110px"},class:"text-end"},X={class:"fs-6 mb-0"},Y={style:{width:"30px"},class:"text-end p-0"},Z=["onClick"],tt={class:"text-muted"},st=l(()=>t("td",null,"總計",-1)),et={key:0,class:"text-end"},ot={key:1,class:"text-end"},nt=l(()=>t("td",null,null,-1)),lt={colspan:"4"},at={class:"input-group"},dt=["disabled","placeholder"],ct={colspan:"4"},it=l(()=>t("button",{type:"button",class:"btn btn-outline-primary w-100",style:{height:"38px"}}," 前往商品列表 ",-1)),rt=l(()=>t("button",{type:"button",class:"btn btn-outline-success w-100",style:{height:"38px"}}," 前往購物車 ",-1));function pt(s,a,ut,ht,c,f){const p=w("router-link");return o(),n("div",I,[t("div",U,[t("div",$,[t("h2",null,d(c.title),1),s.cartList.length!==0?(o(),n("button",{key:0,onClick:a[0]||(a[0]=(...e)=>s.deleteCarts&&s.deleteCarts(...e)),type:"button",class:"btn btn-outline-danger btn-sm",style:{height:"38px"}}," 清空購物車 ")):h("",!0)]),t("div",D,[t("table",T,[j,t("tbody",null,[s.cartList.length===0?(o(),n("tr",z,F)):(o(!0),n(S,{key:1},x(s.cartList,e=>(o(),n("tr",{key:e.id},[t("td",M,[t("img",{src:e.product.imageUrl,class:"rounded cart-img"},null,8,N)]),t("td",Q,[t("div",A,[t("div",G,[_(t("input",{disable:e.id===s.loadingStatus.updateQty,onClick:i=>s.putCart(e),"onUpdate:modelValue":i=>e.qty=i,type:"number",min:"1",class:"form-control"},null,8,J),[[b,e.qty]]),t("span",H,d(e.product.unit),1)]),t("div",K,[t("button",{class:y([{"d-none":e.qty>1},"btn btn-outline-danger"]),onClick:i=>s.deleteCart(e.id),type:"button",style:{scale:"60%"}},R,10,O),e.id===s.loadingStatus.updateQty?(o(),n("span",{key:0,class:y([{"d-none":e.qty===1},"spinner-border spinner-border-sm ms-2"]),role:"status","aria-hidden":"true"},null,2)):h("",!0)])])]),t("td",W,[t("p",X,d(e.product.price)+"元",1)]),t("td",Y,[t("button",{onClick:i=>s.deleteCart(e.id),type:"button",class:"btn btn-outline-danger btn-sm py-0",style:{scale:"80%"}}," x ",8,Z)])]))),128))]),t("tfoot",null,[t("tr",null,[t("td",null,[t("small",tt,d(`總共 ${s.cartList.length} 項`),1)]),st,s.couponState.success?(o(),n("td",ot,d(Math.round(s.couponState.data.final_total))+"元",1)):(o(),n("td",et,d(s.cartTotal)+"元",1)),nt]),t("tr",null,[t("td",lt,[t("div",at,[_(t("input",{disabled:s.couponState.success,"onUpdate:modelValue":a[1]||(a[1]=e=>c.couponCode=e),type:"text",class:"form-control",placeholder:s.couponState.success?s.couponState.message:"請輸入優惠碼","aria-label":"coupon_code","aria-describedby":"coupon_code"},null,8,dt),[[b,c.couponCode]]),t("button",{onClick:a[2]||(a[2]=e=>f.applyCoupon(c.couponCode)),class:"btn btn-secondary",type:"button",id:"coupon_code"},"套用優惠卷")])])]),t("tr",null,[t("td",ct,[s.cartList.length===0?(o(),m(p,{key:0,to:{name:"products"}},{default:C(()=>[it]),_:1})):(o(),m(p,{key:1,to:{name:"cart"}},{default:C(()=>[rt]),_:1}))])])])])])])])}const mt=v(q,[["render",pt],["__scopeId","data-v-9e67b2d9"]]);export{mt as C};
